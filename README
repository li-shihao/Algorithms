Following the book Competitive Programming 3